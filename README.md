# Описание проекта

Проект посвящен решеню задачи прогнозирования сердечных заболеваний. Ссылка на исходную выборку: https://www.kaggle.com/datasets/krishujeniya/heart-diseae 

# Запуск
```
git clone https://github.com/ShasherinaAV/lab_IIS.git/
cd {директория с проектом}
python3 -m venv .venv_IIS
source .venv_IIS/bin/activate
pip install -r requirements.txt
```
<u>Запуск MLFlow</u> 

Скрипт для запуска MLFlow находится в папке mlflow в файле start_mlflow.

Для локального развертывания MLFlow достаточно перейтив папку со скриптом и выполнить команду:

```
sh start_mlflow.sh
```

Проверить, что фреймворк успешно запустился, можно пройдя в браузере на http://localhost:5000/.

# Описани датасета


Набор данных состоит из медицинских карт 303 пациентов, каждая из которых характеризуется 14 различными признаками, которые могут быть полезны для прогнозирования сердечно-сосудистых заболеваний. В набор данных включены следующие атрибуты:

1. <u>age</u> - возраст пациента в годах (29 - 77)
2. sex - пол пациента (0 = женщина, 1 = мужчина)
3. cp - тип боли в груди (0 = типичная стенокардия, 1 = атипичная стенокардия, 2 = неангиальная боль, 3 = бессимптомная) 0 - боль за груlиной при физ. нагрузке, атипичная - хер знает, видимо передается в другое место от груди не за грудиной, 3 - боли не связанные с физической нагрузкой и локализованные не за грудиной
4. <u>trestbps</u> - артериальное давление в состоянии покоя измеренное в мм рт.ст. при поступлении. (94 - 200), 100-130 норм, то как кровь давит на сосуды
5. <u>chol</u> - уровень холестерина в крови в мг/дл. (126 - 564) чем выше тем хуже
6. fbs - уровень сахара в крови натощак > 120 мг/дл? (1 = верно, 0 = неверно), чем больше тес выше риск
7. restecg - результаты электрокардиографии в состоянии покоя (0 = в норме, 1 = аномалия зубца ST-T, 2 = возможная или определенная гипертрофия левого желудочка)
8. <u>thalach</u> - максимальная достигнутая частота сердечных сокращений, достигнутая во время тестирования с физической нагрузкой (71 - 202), чсс пульса чем больше тем хуже, пульс и чсс не одно и то же, чсс - то как сердце бьется, а пусьльс - это то, как волна до руки доходит
9. exang - была ли у пациента стенокардия, вызванная физической нагрузкой (1 = да; 0 = нет) стенакордия - это когда боли за грудной клетке при физ нагрузке, когда сердцу не хватает крови, да - плохо, нет - хорошо
10. <u>oldpeak</u> - депрессия сегмента ST, наблюдаемая на электрокардиограмме во время физической нагрузки по сравнению с отдыхом. (0 - 6.2), нету - хорошо, есть - плохо
11. slope - описывает наклон сегмента ST при максимальной нагрузке (0 = наклонный вверх, 1 = плоский, 2 = наклонный вниз ) наклон между зубцами на электрокардиограмме , up 0 - плохо, изолиния норм, а вверх тоже так себе
12. ca - количество крупных сосудов, видимых при коронарография. (0-4) чем больше тем лучше
13. thal - талассемия, заболевание крови (1 = нормальное, 2 = фиксированный дефект, 3 = обратимый дефект) 
14. target - указывает на наличие или отсутствие сердечно-сосудистых заболеваний  (1 = наличие, 0 = отсутствие)

# Исследование данных

<u>В ходе исследования были проведены действия:</u>
* Изменен тип данных с числового на категориальный для 9 столбцов (sex, cp, fbs, restecg, exang, slope, ca, thal, target)
* изменен тип данных с int64 на int8/int16  для 4 столбцов (age, trestbps, chol, thalach)
* изменен тип данных с float164 float16 для 1 столбца (oldpeak)

Начальный объем датасета: 33.3 KB --> Итоговый объем датасета: 6.8 KB

<u> В ходе анализа были выявлены следующие закономерности:</u>

* У мужчин сердечные заболевания встречаются чаще, чем у женщин (см график `./eda/graph1.png`)
* Корреляция признаков слабая. Только у максимальной частотой сердечных сокращений (thalach) с возрастом (age) и депрессией ST (oldpeak) наблюдается некоторая корреляция (см график `./eda/graph2.png`)
* Нулевой и третий типы боли сердца в среднем встречаются у людей более старшего возраста (см график `./eda/graph3.png`)
* Зависимость уровня холестерина в крови от возраста (см график `./eda/graph4.png`)

Обработанная выборка сохранена в файл `clean_data.pkl`




# Лабораторная работа №2. Проведение экспериментов по настройке модели

*Цель работы*: Провести ряд экспериментов по настройке модели, логируя все результаты в MLFlow. Научиться пользоваться инструментами autofeat, mlxtend, MLFlow